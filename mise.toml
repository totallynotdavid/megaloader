[settings]
python.uv_venv_auto = true

[tools]
uv = "0.9.7"
ruff = "0.14.3"
bun = "1.3.1"
biome = "2.3.2"

[tasks.install]
description = "Install dependencies"
alias = "i"
run = [
  "uv sync --all-groups",
  "uv pip install -e packages/core -e packages/cli",
]

[tasks.update]
description = "Update all dependencies"
alias = "u"
run = "uv sync -U"

[tasks.outdated]
description = "List outdated dependencies"
alias = "o"
run = "uv pip list --outdated"

[tasks.format]
description = "Lint & format (fix by default)"
alias = "f"
run = [
  "ruff format . --config pyproject.toml",
  "ruff check --fix --unsafe-fixes . --config pyproject.toml",
]

[tasks.format-docs]
description = "Format docs with biome"
alias = "fd"
run = "biome format --write ."
dir = "docs"

[tasks.mypy]
description = "Type check with mypy"
alias = "m"
run = "uv run mypy packages/core/megaloader --config-file pyproject.toml"

[tasks.test]
description = "Run the pytest suite, including live tests"
alias = "t"
run = "uv run pytest packages/core/tests --run-live"

[tasks.test-unit]
description = "Run unit tests only"
alias = "tu"
run = "uv run pytest packages/core/tests/unit"

[tasks.test-integration]
description = "Run integration tests only"
alias = "ti"
run = "uv run pytest packages/core/tests/integration"

[tasks.docs-serve]
description = "Serve documentation locally"
alias = "ds"
run = ["bun install", "bun run docs:dev"]
dir = "docs"

[tasks.docs-build]
description = "Build documentation"
alias = "db"
run = ["bun install", "bun run docs:build"]
dir = "docs"

[tasks.api-serve]
description = "Run local API server for development"
alias = "as"
run = "uv run uvicorn main:app --reload"
dir = "api"

[tasks.api-deploy]
description = "Deploy API to Vercel"
alias = "vda"
run = "vercel --prod"
dir = "api"

[tasks.dev-cli]
description = "Run the CLI during development"
run = "uv run megaloader"
